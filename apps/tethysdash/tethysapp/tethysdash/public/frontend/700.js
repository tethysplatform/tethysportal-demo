"use strict";(self.webpackChunktethysdash_frontend=self.webpackChunktethysdash_frontend||[]).push([[700],{35700:(t,e,i)=>{i.r(e),i.d(e,{default:()=>I});var s=i(43938),r=i(36438),n=i(33513),a=i(79925),o=i(70915),h=i(61597);function c(t,e){const i=(""+t).split("."),s=(""+e).split(".");for(let t=0;t<Math.max(i.length,s.length);t++){const e=parseInt(i[t]||"0",10),r=parseInt(s[t]||"0",10);if(e>r)return 1;if(r>e)return-1}return 0}var u=i(14465),g=i(42192);const l="1.3.0",d=[101,101];function _(t,e,i,s,r){r.WIDTH=i[0],r.HEIGHT=i[1];const n=s.getAxisOrientation(),a=c(r.VERSION,"1.3")>=0;r[a?"CRS":"SRS"]=s.getCode();const o=a&&n.startsWith("ne")?[e[1],e[0],e[3],e[2]]:e;return r.BBOX=o.join(","),(0,u.LW)(t,r)}function p(t,e){return Object.assign({REQUEST:e,SERVICE:"WMS",VERSION:l,FORMAT:"image/png",STYLES:"",TRANSPARENT:"TRUE"},t)}class m extends a.Ay{constructor(t){super({attributions:(t=t||{}).attributions,interpolate:t.interpolate,projection:t.projection,resolutions:t.resolutions}),this.crossOrigin_=void 0!==t.crossOrigin?t.crossOrigin:null,this.url_=t.url,this.imageLoadFunction_=void 0!==t.imageLoadFunction?t.imageLoadFunction:a.VV,this.params_=Object.assign({},t.params),this.serverType_=t.serverType,this.hidpi_=void 0===t.hidpi||t.hidpi,this.renderedRevision_=0,this.ratio_=void 0!==t.ratio?t.ratio:1.5,this.loaderProjection_=null}getFeatureInfoUrl(t,e,i,s){const a=(0,r.Jt)(i),u=this.getProjection();return u&&u!==a&&(e=(0,n.KQ)(u,a,t,e),t=(0,r.pd)(t,a,u)),function(t,e,i){if(void 0===t.url)return;const s=(0,r.Jt)(t.projection||"EPSG:3857"),n=(0,o.Bg)(e,i,0,d),a={QUERY_LAYERS:t.params.LAYERS,INFO_FORMAT:"application/json"};Object.assign(a,p(t.params,"GetFeatureInfo"),t.params);const u=(0,h.RI)((e[0]-n[0])/i,g.B),l=(0,h.RI)((n[3]-e[1])/i,g.B),m=c(a.VERSION,"1.3")>=0;return a[m?"I":"X"]=u,a[m?"J":"Y"]=l,_(t.url,n,d,s,a)}({url:this.url_,params:{...this.params_,...s},projection:u||a},t,e)}getLegendUrl(t,e){return function(t,e){if(void 0===t.url)return;const i={SERVICE:"WMS",VERSION:l,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(void 0!==e){const s=(0,r.Jt)(t.projection||"EPSG:3857").getMetersPerUnit()||1,n=28e-5;i.SCALE=e*s/n}if(Object.assign(i,t.params),void 0!==t.params&&void 0===i.LAYER){const t=i.LAYERS;if(Array.isArray(t)&&1===t.length)return;i.LAYER=t}return(0,u.LW)(t.url,i)}({url:this.url_,params:{...this.params_,...e}},t)}getParams(){return this.params_}getImageInternal(t,e,i,n){return void 0===this.url_?null:(this.loader&&this.loaderProjection_===n||(this.loaderProjection_=n,this.loader=function(t){const e=void 0===t.hidpi||t.hidpi,i=(0,r.Jt)(t.projection||"EPSG:3857"),n=t.ratio||1.5,c=t.load||s.D4,u=t.crossOrigin??null;return(s,r,l)=>{s=(0,a.QD)(s,r,l,n),1==l||e&&void 0!==t.serverType||(l=1);const d=function(t,e,i,s,r,n,a){n=Object.assign({REQUEST:"GetMap"},n);const c=e/i,u=[(0,h.LI)((0,o.RG)(t)/c,g.B),(0,h.LI)((0,o.Oq)(t)/c,g.B)];if(1!=i)switch(a){case"geoserver":const t=90*i+.5|0;"FORMAT_OPTIONS"in n?n.FORMAT_OPTIONS+=";dpi:"+t:n.FORMAT_OPTIONS="dpi:"+t;break;case"mapserver":n.MAP_RESOLUTION=90*i;break;case"carmentaserver":case"qgis":n.DPI=90*i;break;default:throw new Error("Unknown `serverType` configured")}return _(r,t,u,s,n)}(s,r,l,i,t.url,p(t.params,"GetMap"),t.serverType),m=new Image;return m.crossOrigin=u,c(m,d).then((t=>({image:t,extent:s,pixelRatio:l})))}}({crossOrigin:this.crossOrigin_,params:this.params_,projection:n,serverType:this.serverType_,hidpi:this.hidpi_,url:this.url_,ratio:this.ratio_,load:(t,e)=>(this.image.setImage(t),this.imageLoadFunction_(this.image,e),(0,s.D4)(t))})),super.getImageInternal(t,e,i,n))}getImageLoadFunction(){return this.imageLoadFunction_}getUrl(){return this.url_}setImageLoadFunction(t){this.imageLoadFunction_=t,this.changed()}setUrl(t){t!=this.url_&&(this.url_=t,this.loader=null,this.changed())}updateParams(t){Object.assign(this.params_,t),this.changed()}changed(){this.image=null,super.changed()}}const I=m},42192:(t,e,i)=>{i.d(e,{B:()=>s});const s=4},79925:(t,e,i)=>{i.d(e,{Ay:()=>f,VV:()=>j,QD:()=>v});var s=i(43938),r=i(6141),n=i(66514),a=i(1685),o=i(6837),h=i(70915),c=i(61597),u=i(36438),g=i(9438),l=i(33513);function d(t){return Array.isArray(t)?Math.min(...t):t}var _=i(52913),p=i(93101);class m extends s.Ay{constructor(t,e,i,s,n,a,o){let c=t.getExtent();c&&t.canWrapX()&&(c=c.slice(),c[0]=-1/0,c[2]=1/0);let u=e.getExtent();u&&e.canWrapX()&&(u=u.slice(),u[0]=-1/0,u[2]=1/0);const g=u?(0,h._N)(i,u):i,d=(0,h.q1)(g),m=(0,l.KQ)(t,e,d,s),I=p.l,R=new _.A(t,e,g,c,m*I,s),E=R.calculateSourceExtent(),A=(0,h.Im)(E)?null:a(E,m,n),O=A?r.A.IDLE:r.A.EMPTY,j=A?A.getPixelRatio():1;super(i,s,j,O),this.targetProj_=e,this.maxSourceExtent_=c,this.triangulation_=R,this.targetResolution_=s,this.targetExtent_=i,this.sourceImage_=A,this.sourcePixelRatio_=j,this.interpolate_=o,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){this.state==r.A.LOADING&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){const t=this.sourceImage_.getState();if(t==r.A.LOADED){const t=(0,h.RG)(this.targetExtent_)/this.targetResolution_,e=(0,h.Oq)(this.targetExtent_)/this.targetResolution_;this.canvas_=(0,l.XX)(t,e,this.sourcePixelRatio_,d(this.sourceImage_.getResolution()),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_,!0)}this.state=t,this.changed()}load(){if(this.state==r.A.IDLE){this.state=r.A.LOADING,this.changed();const t=this.sourceImage_.getState();t==r.A.LOADED||t==r.A.ERROR?this.reproject_():(this.sourceListenerKey_=(0,g.KT)(this.sourceImage_,o.A.CHANGE,(t=>{const e=this.sourceImage_.getState();e!=r.A.LOADED&&e!=r.A.ERROR||(this.unlistenSource_(),this.reproject_())})),this.sourceImage_.load())}}unlistenSource_(){(0,g.JH)(this.sourceListenerKey_),this.sourceListenerKey_=null}}const I=m;var R=i(16444),E=i(42192);class A extends a.Ay{constructor(t,e){super(t),this.image=e}}class O extends R.A{constructor(t){super({attributions:t.attributions,projection:t.projection,state:t.state,interpolate:void 0===t.interpolate||t.interpolate}),this.on,this.once,this.un,this.loader=t.loader||null,this.resolutions_=void 0!==t.resolutions?t.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0,this.image=null,this.wantedExtent_,this.wantedResolution_,this.static_=!!t.loader&&0===t.loader.length,this.wantedProjection_=null}getResolutions(){return this.resolutions_}setResolutions(t){this.resolutions_=t}findNearestResolution(t){const e=this.getResolutions();return e&&(t=e[(0,n.FT)(e,t,0)]),t}getImage(t,e,i,s){const r=this.getProjection();if(!r||!s||(0,u.tI)(r,s))return r&&(s=r),this.getImageInternal(t,e,i,s);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&(0,u.tI)(this.reprojectedImage_.getProjection(),s)&&this.reprojectedImage_.getResolution()==e&&(0,h.aI)(this.reprojectedImage_.getExtent(),t))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new I(r,s,t,e,i,((t,e,i)=>this.getImageInternal(t,e,i,r)),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(t,e,i,r){if(this.loader){const n=v(t,e,i,1),a=this.findNearestResolution(e);if(this.image&&(this.static_||this.wantedProjection_===r&&(this.wantedExtent_&&(0,h.ms)(this.wantedExtent_,n)||(0,h.ms)(this.image.getExtent(),n))&&(this.wantedResolution_&&d(this.wantedResolution_)===a||d(this.image.getResolution())===a)))return this.image;this.wantedProjection_=r,this.wantedExtent_=n,this.wantedResolution_=a,this.image=new s.Ay(n,a,i,this.loader),this.image.addEventListener(o.A.CHANGE,this.handleImageChange.bind(this))}return this.image}handleImageChange(t){const e=t.target;let i;switch(e.getState()){case r.A.LOADING:this.loading=!0,i="imageloadstart";break;case r.A.LOADED:this.loading=!1,i="imageloadend";break;case r.A.ERROR:this.loading=!1,i="imageloaderror";break;default:return}this.hasListener(i)&&this.dispatchEvent(new A(i,e))}}function j(t,e){t.getImage().src=e}function v(t,e,i,s){const r=e/i,n=(0,h.q1)(t),a=(0,c.mk)((0,h.RG)(t)/r,E.B),o=(0,c.mk)((0,h.Oq)(t)/r,E.B),u=a+2*(0,c.mk)((s-1)*a/2,E.B),g=o+2*(0,c.mk)((s-1)*o/2,E.B);return(0,h.Bg)(n,r,0,[u,g])}const f=O}}]);